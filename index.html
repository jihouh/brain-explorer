<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Explorer Academy - Parent Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --focus-blue: #4ECDC4;
            --memory-green: #95E1D3;
            --challenge-orange: #F38181;
            --plan-purple: #AA96DA;
            --gold: #FFD93D;
            --dark: #2C3E50;
            --light: #F7F9FC;
            --parent-teal: #2A9D8F;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .game-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .game-header h1 {
            font-family: 'Fredoka One', cursive;
            font-size: 3em;
            text-shadow: 3px 3px 0px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        /* Screens */
        .screen {
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .card h2 {
            color: var(--dark);
            margin-bottom: 15px;
            font-family: 'Fredoka One', cursive;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card h3 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--focus-blue), #3dbdb4);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Fredoka One', cursive;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.4);
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.6);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--plan-purple), #8b7bc7);
            box-shadow: 0 4px 15px rgba(170, 150, 218, 0.4);
        }
        
        .btn-orange {
            background: linear-gradient(135deg, var(--challenge-orange), #e85a5a);
            box-shadow: 0 4px 15px rgba(243, 129, 129, 0.4);
        }
        
        .btn-green {
            background: linear-gradient(135deg, var(--memory-green), #7bc4b5);
            box-shadow: 0 4px 15px rgba(149, 225, 211, 0.4);
            color: var(--dark);
        }
        
        .btn-parent {
            background: linear-gradient(135deg, var(--parent-teal), #21867a);
            box-shadow: 0 4px 15px rgba(42, 157, 143, 0.4);
        }
        
        /* Parent Dashboard Specific */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-family: 'Fredoka One', cursive;
            font-size: 3em;
            color: var(--dark);
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-weight: 600;
        }
        
        /* Progress Bars */
        .skill-bar {
            margin: 15px 0;
        }
        
        .skill-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .progress-bg {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .fill-focus { background: linear-gradient(90deg, var(--focus-blue), #3dbdb4); }
        .fill-memory { background: linear-gradient(90deg, var(--memory-green), #7bc4b5); color: var(--dark); }
        .fill-challenge { background: linear-gradient(90deg, var(--challenge-orange), #e85a5a); }
        .fill-plan { background: linear-gradient(90deg, var(--plan-purple), #8b7bc7); }
        
        /* Activity Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--focus-blue), var(--plan-purple));
            border-radius: 3px;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -26px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            border: 3px solid;
        }
        
        .timeline-focus { border-left-color: var(--focus-blue); }
        .timeline-focus::before { border-color: var(--focus-blue); }
        .timeline-memory { border-left-color: var(--memory-green); }
        .timeline-memory::before { border-color: var(--memory-green); }
        .timeline-challenge { border-left-color: var(--challenge-orange); }
        .timeline-challenge::before { border-color: var(--challenge-orange); }
        .timeline-plan { border-left-color: var(--plan-purple); }
        .timeline-plan::before { border-color: var(--plan-purple); }
        
        .timeline-date {
            font-size: 0.85em;
            color: #888;
            margin-bottom: 5px;
        }
        
        .timeline-title {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        /* Tips Section */
        .tip-card {
            background: linear-gradient(135deg, #fff9e6 0%, #fff5d6 100%);
            border: 2px solid var(--gold);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
        }
        
        .tip-card::before {
            content: 'üí°';
            position: absolute;
            top: -15px;
            left: 20px;
            background: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 1.2em;
            border: 2px solid var(--gold);
        }
        
        .tip-card h4 {
            color: var(--dark);
            margin-bottom: 10px;
            margin-top: 10px;
            font-family: 'Fredoka One', cursive;
        }
        
        .tip-card p {
            color: #555;
            line-height: 1.6;
        }
        
        .tip-action {
            background: white;
            padding: 10px 15px;
            border-radius: 10px;
            margin-top: 10px;
            border-left: 4px solid var(--gold);
            font-style: italic;
        }
        
        /* Insights */
        .insight-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid #2196F3;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .insight-box strong {
            color: #1565C0;
            display: block;
            margin-bottom: 5px;
        }
        
        /* Comparison Chart */
        .comparison-chart {
            display: flex;
            height: 200px;
            align-items: flex-end;
            justify-content: space-around;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .chart-bar {
            width: 60px;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s;
            position: relative;
            cursor: pointer;
        }
        
        .chart-bar:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }
        
        .chart-bar::after {
            content: attr(data-value);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            color: var(--dark);
        }
        
        .chart-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9em;
            font-weight: 600;
            white-space: nowrap;
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 30px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle.active {
            background: var(--parent-teal);
        }
        
        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .toggle.active .toggle-slider {
            transform: translateX(30px);
        }
        
        /* Password Protection */
        .parent-gate {
            text-align: center;
            padding: 40px;
        }
        
        .parent-gate h2 {
            color: var(--dark);
            margin-bottom: 20px;
        }
        
        .pin-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .pin-digit {
            width: 50px;
            height: 60px;
            font-size: 1.5em;
            text-align: center;
            border: 3px solid #ddd;
            border-radius: 10px;
            font-family: 'Nunito', sans-serif;
        }
        
        .pin-digit:focus {
            outline: none;
            border-color: var(--parent-teal);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .game-header h1 { font-size: 2em; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .comparison-chart { height: 150px; }
            .chart-bar { width: 40px; }
        }
        
        /* Utility */
        .text-center { text-align: center; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .hidden { display: none !important; }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--gold);
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            z-index: 1000;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        /* Print Styles */
        @media print {
            .btn, .toggle-container { display: none; }
            .card { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="game-header">
            <h1>üß† Brain Explorer Academy</h1>
            <p class="subtitle">Parent Dashboard & Progress Tracker</p>
        </div>

        <!-- Navigation -->
        <div class="card" style="padding: 15px; text-align: center;">
            <button class="btn" onclick="showScreen('screen-kids')">üë¶ Kids Mode</button>
            <button class="btn btn-parent" onclick="showParentGate()">üë®‚Äçüë©‚Äçüëß Parent Dashboard</button>
            <button class="btn btn-purple" onclick="exportData()">üìä Export Report</button>
        </div>

        <!-- Screen: Parent Gate -->
        <div id="screen-parent-gate" class="screen">
            <div class="card parent-gate">
                <h2>üîí Parent Area</h2>
                <p>Enter the magic number to access progress tracking:</p>
                <div class="pin-input">
                    <input type="password" class="pin-digit" maxlength="1" id="pin1" onkeyup="movePin(1)">
                    <input type="password" class="pin-digit" maxlength="1" id="pin2" onkeyup="movePin(2)">
                    <input type="password" class="pin-digit" maxlength="1" id="pin3" onkeyup="movePin(3)">
                    <input type="password" class="pin-digit" maxlength="1" id="pin4" onkeyup="checkPin()">
                </div>
                <p style="color: #888; font-size: 0.9em;">Hint: The year you were born (4 digits)</p>
                <button class="btn btn-parent mt-20" onclick="checkPin()">Unlock üîì</button>
            </div>
        </div>

        <!-- Screen: Parent Dashboard -->
        <div id="screen-parent" class="screen">
            <!-- Overview Stats -->
            <div class="card">
                <h2>üìà Learning Overview</h2>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Play Time</div>
                        <div class="stat-number" id="total-time">0m</div>
                        <div style="font-size: 0.9em; color: #666;">This week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Missions Completed</div>
                        <div class="stat-number" id="total-missions">0</div>
                        <div style="font-size: 0.9em; color: #666;">Out of 12</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Current Level</div>
                        <div class="stat-number" id="current-level">1</div>
                        <div style="font-size: 0.9em; color: #666;" id="level-title">Trainee</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Brain Power</div>
                        <div class="stat-number" id="total-power">0</div>
                        <div style="font-size: 0.9em; color: #666;">Total crystals</div>
                    </div>
                </div>
            </div>

            <!-- Skill Breakdown -->
            <div class="card">
                <h2>üéØ Skill Development</h2>
                <div class="skill-bar">
                    <div class="skill-header">
                        <span>‚ö° Focus & Attention</span>
                        <span id="score-focus">0/10</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill fill-focus" id="bar-focus" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-bar">
                    <div class="skill-header">
                        <span>üå± Memory & Retention</span>
                        <span id="score-memory">0/10</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill fill-memory" id="bar-memory" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-bar">
                    <div class="skill-header">
                        <span>üí™ Challenge & Resilience</span>
                        <span id="score-challenge">0/10</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill fill-challenge" id="bar-challenge" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-bar">
                    <div class="skill-header">
                        <span>üó∫Ô∏è Planning & Organization</span>
                        <span id="score-plan">0/10</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill fill-plan" id="bar-plan" style="width: 0%">0%</div>
                    </div>
                </div>
                
                <div class="comparison-chart" id="skill-chart">
                    <div class="chart-bar fill-focus" data-value="0" style="height: 0%">
                        <span class="chart-label">Focus</span>
                    </div>
                    <div class="chart-bar fill-memory" data-value="0" style="height: 0%">
                        <span class="chart-label">Memory</span>
                    </div>
                    <div class="chart-bar fill-challenge" data-value="0" style="height: 0%">
                        <span class="chart-label">Challenge</span>
                    </div>
                    <div class="chart-bar fill-plan" data-value="0" style="height: 0%">
                        <span class="chart-label">Plan</span>
                    </div>
                </div>
            </div>

            <!-- Insights -->
            <div class="card">
                <h2>üîç Smart Insights</h2>
                <div id="insights-container">
                    <div class="insight-box">
                        <strong>üåü Keep Exploring!</strong>
                        Your child hasn't started their adventure yet. Encourage them to try their first mission!
                    </div>
                </div>
            </div>

            <!-- Personalized Tips -->
            <div class="card">
                <h2>üí° Personalized Parent Tips</h2>
                <div id="tips-container">
                    <!-- Dynamically populated -->
                </div>
                
                <div class="toggle-container">
                    <span>Show offline activity ideas</span>
                    <div class="toggle" id="offline-toggle" onclick="toggleOffline()">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                
                <div id="offline-ideas" class="hidden">
                    <div class="tip-card">
                        <h4>Focus Falls - Offline Activity</h4>
                        <p><strong>Spotlight Scavenger Hunt:</strong> Give your child a flashlight. Hide 5 soft toys around a darkened room. They must keep the light on each toy for 5 seconds while you make distracting noises.</p>
                        <div class="tip-action">Ask afterwards: "What happened when you heard the noise? How did you bring your attention back?"</div>
                    </div>
                    
                    <div class="tip-card">
                        <h4>Memory Meadows - Offline Activity</h4>
                        <p><strong>Shopping List Game:</strong> Start with "I went to the store and bought..." Take turns adding items. See how many you can remember in order!</p>
                        <div class="tip-action">Strategy tip: Encourage your child to "make a movie in their mind" of the items interacting.</div>
                    </div>
                    
                    <div class="tip-card">
                        <h4>Challenge Canyon - Offline Activity</h4>
                        <p><strong>The Tower of YET:</strong> Build a card tower together. When it falls, practice saying "It didn't work... YET!" and try a different technique.</p>
                        <div class="tip-action">Model making mistakes yourself and verbalize your thinking: "Hmm, that didn't work. What else could I try?"</div>
                    </div>
                    
                    <div class="tip-card">
                        <h4>Plan Peak - Offline Activity</h4>
                        <p><strong>Morning Routine Map:</strong> Draw pictures of morning tasks (wake up, dress, breakfast, brush teeth). Let your child arrange them in order.</p>
                        <div class="tip-action">Use "First/Then" language: "First we put on shoes, then we can play."</div>
                    </div>
                </div>
            </div>

            <!-- Activity Timeline -->
            <div class="card">
                <h2>üìÖ Recent Activity</h2>
                <div class="timeline" id="activity-timeline">
                    <!-- Dynamically populated -->
                </div>
                <div id="no-activity" class="text-center" style="color: #888; padding: 20px;">
                    No activities recorded yet. Start playing to see history!
                </div>
            </div>

            <!-- Weekly Report -->
            <div class="card">
                <h2>üìã Weekly Summary</h2>
                <div id="weekly-report">
                    <p><strong>Strengths:</strong> <span id="strengths">Not enough data yet</span></p>
                    <p><strong>Growth Areas:</strong> <span id="growth-areas">Not enough data yet</span></p>
                    <p><strong>Recommended Focus:</strong> <span id="recommendation">Try any island to begin!</span></p>
                </div>
                <button class="btn btn-green mt-20" onclick="generateReport()">Generate Full Report üìÑ</button>
            </div>
        </div>

        <!-- Screen: Kids Mode (Placeholder for main game) -->
        <div id="screen-kids" class="screen active">
            <div class="card text-center">
                <h2>üë¶ Kids Adventure Mode</h2>
                <p style="margin: 20px 0; color: #666;">Click below to start your Brain Explorer adventure!</p>
                <button class="btn" style="font-size: 1.3em; padding: 20px 40px;" onclick="alert('In the full version, this would launch the kids game interface!')">Start Playing! üöÄ</button>
                <p style="margin-top: 20px; color: #888; font-size: 0.9em;">This is the parent dashboard demo.<br>In the full version, this button opens the complete game.</p>
            </div>
        </div>
    </div>

    <script>
        // Demo Data - In real version, this would load from localStorage
        let gameData = {
            name: 'Alex',
            avatar: 'ü¶Å',
            level: 2,
            title: 'Ranger',
            stats: {
                focus: 6,
                memory: 4,
                challenge: 8,
                plan: 3
            },
            missionsCompleted: {
                focus: 2,
                memory: 1,
                challenge: 3,
                plan: 1
            },
            crystals: 18,
            playTime: 145, // minutes
            sessions: [
                { date: '2026-02-17', island: 'challenge', mission: 'The Learning Pit', duration: 15, reflection: 'Kept trying different strategies' },
                { date: '2026-02-17', island: 'focus', mission: 'The Laser Bridge', duration: 12, reflection: 'Noticed distraction and returned to task' },
                { date: '2026-02-16', island: 'challenge', mission: 'Yet Tower', duration: 18, reflection: 'Used the word YET when tower fell' },
                { date: '2026-02-16', island: 'memory', mission: 'Seed Planting', duration: 14, reflection: 'Made pictures in head to remember' },
                { date: '2026-02-15', island: 'plan', mission: 'Treasure Hunt Map', duration: 16, reflection: 'Understood sequence importance' },
                { date: '2026-02-15', island: 'focus', mission: 'Sound Hunter', duration: 11, reflection: 'Repeated pattern quietly' },
                { date: '2026-02-14', island: 'challenge', mission: 'Mistake Museum', duration: 20, reflection: 'Drew a mistake and what was learned' }
            ]
        };

        // Screen Management
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'screen-parent') {
                updateParentDashboard();
            }
        }

        // Parent Gate
        function showParentGate() {
            showScreen('screen-parent-gate');
            document.getElementById('pin1').focus();
        }

        function movePin(n) {
            if (n < 4) document.getElementById(`pin${n+1}`).focus();
        }

        function checkPin() {
            const pin = document.getElementById('pin1').value + 
                       document.getElementById('pin2').value + 
                       document.getElementById('pin3').value + 
                       document.getElementById('pin4').value;
            
            // Simple parent gate - in real version, use a better method
            if (pin.length === 4) {
                showScreen('screen-parent');
                // Clear pins
                for(let i=1; i<=4; i++) document.getElementById(`pin${i}`).value = '';
            } else {
                alert('Please enter all 4 digits');
            }
        }

        // Update Dashboard
        function updateParentDashboard() {
            // Basic stats
            document.getElementById('total-time').textContent = gameData.playTime + 'm';
            const totalMissions = Object.values(gameData.missionsCompleted).reduce((a,b) => a+b, 0);
            document.getElementById('total-missions').textContent = totalMissions;
            document.getElementById('current-level').textContent = gameData.level;
            document.getElementById('level-title').textContent = gameData.title;
            document.getElementById('total-power').textContent = gameData.crystals;

            // Skill bars
            const maxScore = 10;
            for (let skill in gameData.stats) {
                const score = gameData.stats[skill];
                const percent = (score / maxScore) * 100;
                document.getElementById(`score-${skill}`).textContent = `${score}/${maxScore}`;
                document.getElementById(`bar-${skill}`).style.width = percent + '%';
                document.getElementById(`bar-${skill}`).textContent = Math.round(percent) + '%';
            }

            // Chart
            const chartBars = document.querySelectorAll('.chart-bar');
            const skills = ['focus', 'memory', 'challenge', 'plan'];
            chartBars.forEach((bar, idx) => {
                const score = gameData.stats[skills[idx]];
                bar.style.height = (score / maxScore * 100) + '%';
                bar.setAttribute('data-value', score);
            });

            // Generate insights
            generateInsights();

            // Generate tips
            generateTips();

            // Timeline
            updateTimeline();

            // Weekly report
            generateWeeklyReport();
        }

        function generateInsights() {
            const container = document.getElementById('insights-container');
            const insights = [];
            
            const totalMissions = Object.values(gameData.missionsCompleted).reduce((a,b) => a+b, 0);
            
            if (totalMissions === 0) {
                container.innerHTML = `
                    <div class="insight-box">
                        <strong>üåü Ready to Start!</strong>
                        Your child hasn't begun their adventure yet. Encourage them to explore Focus Falls first‚Äîit's the foundation for all other skills!
                    </div>`;
                return;
            }

            // Find strongest skill
            let strongest = Object.entries(gameData.stats).sort((a,b) => b[1]-a[1])[0];
            insights.push({
                icon: 'üèÜ',
                title: 'Strongest Skill',
                text: `Your child shows great strength in ${strongest[0]} (${strongest[1]}/10). This will help them tackle difficult tasks in other areas!`,
                color: '#4CAF50'
            });

            // Find growth area
            let weakest = Object.entries(gameData.stats).sort((a,b) => a[1]-b[1])[0];
            if (weakest[1] < 5) {
                insights.push({
                    icon: 'üå±',
                    title: 'Growth Opportunity',
                    text: `${weakest[0].charAt(0).toUpperCase() + weakest[0].slice(1)} could use more practice. Try the offline activities below!`,
                    color: '#FF9800'
                });
            }

            // Consistency insight
            if (gameData.sessions.length >= 3) {
                const recentSessions = gameData.sessions.slice(0, 3);
                const avgTime = recentSessions.reduce((a,b) => a + b.duration, 0) / 3;
                insights.push({
                    icon: '‚è∞',
                    title: 'Session Length',
                    text: `Average session: ${Math.round(avgTime)} minutes. ${avgTime > 15 ? 'Great focus endurance!' : 'Short bursts work well for this age.'}`,
                    color: '#2196F3'
                });
            }

            // Reflection quality
            const goodReflections = gameData.sessions.filter(s => s.reflection && s.reflection.length > 10).length;
            if (goodReflections > 0) {
                insights.push({
                    icon: 'ü§î',
                    title: 'Metacognition Growing',
                    text: `Your child is articulating their learning strategies! This "thinking about thinking" is a key skill.`,
                    color: '#9C27B0'
                });
            }

            container.innerHTML = insights.map(i => `
                <div class="insight-box" style="border-left-color: ${i.color}; background: linear-gradient(135deg, ${i.color}15 0%, ${i.color}08 100%);">
                    <strong>${i.icon} ${i.title}</strong>
                    ${i.text}
                </div>
            `).join('');
        }

        function generateTips() {
            const container = document.getElementById('tips-container');
            const tips = [];

            // Analyze patterns and generate specific tips
            const challengeScore = gameData.stats.challenge;
            const focusScore = gameData.stats.focus;
            
            if (challengeScore > focusScore + 2) {
                tips.push({
                    title: 'Balance Persistence with Flexibility',
                    content: 'Your child shows great resilience (high Challenge score) but may benefit from strategies to know WHEN to take a break. Teach them: "If I\'m frustrated after 3 tries, I take a breath and try a different way."',
                    action: 'Practice the "3-Then-Break" rule during homework or puzzles.'
                });
            }

            if (gameData.stats.plan < 4) {
                tips.push({
                    title: 'Visual Planning Support',
                    content: 'Planning skills are still developing. Use visual schedules with pictures for daily routines. This reduces cognitive load and builds executive function.',
                    action: 'Create a "First/Then" board for morning or bedtime routines.'
                });
            }

            if (gameData.stats.memory > 6 && gameData.stats.focus < 5) {
                tips.push({
                    title: 'Memory vs. Attention Gap',
                    content: 'Strong memory but variable attention suggests your child absorbs information well when engaged, but may struggle to initiate focus. Use high-interest topics to practice attention skills.',
                    action: 'Practice the spotlight game with their favorite characters/toys.'
                });
            }

            // General tips based on age (6 years old)
            tips.push({
                title: 'The Power of "Yet" at Age 6',
                content: 'Six-year-olds are developing "theory of mind" and can understand that abilities grow. The word "yet" is particularly powerful at this age because it aligns with their emerging understanding of time and change.',
                action: 'Model "yet" in your own speech: "I haven\'t figured this out... yet!"'
            });

            tips.push({
                title: 'Concrete Metaphors Work Best',
                content: 'Abstract concepts like "focus" need physical anchors. The flashlight (spotlight), garden (memory), and maps (planning) in the game work because they\'re tangible.',
                action: 'Use the actual props mentioned in the game during offline play.'
            });

            container.innerHTML = tips.map(t => `
                <div class="tip-card">
                    <h4>${t.title}</h4>
                    <p>${t.content}</p>
                    <div class="tip-action"><strong>Try this:</strong> ${t.action}</div>
                </div>
            `).join('');
        }

        function updateTimeline() {
            const container = document.getElementById('activity-timeline');
            const noActivity = document.getElementById('no-activity');
            
            if (gameData.sessions.length === 0) {
                container.innerHTML = '';
                noActivity.classList.remove('hidden');
                return;
            }
            
            noActivity.classList.add('hidden');
            
            container.innerHTML = gameData.sessions.map(s => `
                <div class="timeline-item timeline-${s.island}">
                    <div class="timeline-date">${formatDate(s.date)} ‚Ä¢ ${s.duration} mins</div>
                    <div class="timeline-title">${s.mission}</div>
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                        <strong>Reflection:</strong> ${s.reflection}
                    </div>
                </div>
            `).join('');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const today = new Date();
            const diff = Math.floor((today - date) / (1000 * 60 * 60 * 24));
            
            if (diff === 0) return 'Today';
            if (diff === 1) return 'Yesterday';
            return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
        }

        function generateWeeklyReport() {
            const skills = Object.entries(gameData.stats);
            const strongest = skills.sort((a,b) => b[1]-a[1])[0];
            const weakest = skills.sort((a,b) => a[1]-b[1])[0];
            
            document.getElementById('strengths').textContent = 
                `${strongest[0].charAt(0).toUpperCase() + strongest[0].slice(1)} (${strongest[1]}/10)`;
            
            document.getElementById('growth-areas').textContent = 
                weakest[1] < 5 ? `${weakest[0].charAt(0).toUpperCase() + weakest[0].slice(1)} needs practice` : 'All skills developing well';
            
            // Recommendation
            let rec = '';
            if (weakest[1] < 4) {
                rec = `Focus on ${weakest[0]} activities this week. Try the offline game suggested above.`;
            } else if (gameData.playTime < 60) {
                rec = 'Aim for 10-15 minutes of play daily to build consistency.';
            } else {
                rec = 'Great progress! Encourage teaching these skills to a stuffed animal or sibling.';
            }
            document.getElementById('recommendation').textContent = rec;
        }

        function toggleOffline() {
            const toggle = document.getElementById('offline-toggle');
            const ideas = document.getElementById('offline-ideas');
            toggle.classList.toggle('active');
            ideas.classList.toggle('hidden');
        }

        function exportData() {
            const report = {
                childName: gameData.name,
                exportDate: new Date().toLocaleDateString(),
                summary: {
                    totalPlayTime: gameData.playTime + ' minutes',
                    missionsCompleted: Object.values(gameData.missionsCompleted).reduce((a,b) => a+b, 0),
                    currentLevel: `Level ${gameData.level} ${gameData.title}`,
                    totalCrystals: gameData.crystals
                },
                skills: gameData.stats,
                recentActivity: gameData.sessions.slice(0, 5),
                recommendations: document.getElementById('recommendation').textContent
            };
            
            const dataStr = JSON.stringify(report, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `BrainExplorer_Report_${gameData.name}_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('Report downloaded! You can open it in any text editor or import it back later.');
        }

        function generateReport() {
            window.print();
        }

        // Confetti effect for celebrations
        function createConfetti() {
            const colors = ['#FFD93D', '#4ECDC4', '#F38181', '#AA96DA', '#2A9D8F'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 30);
            }
        }

        // Initialize with demo data
        window.onload = () => {
            // In real version, load from localStorage here
            console.log('Parent Dashboard loaded with demo data');
        };
    </script>
</body>
</html>
